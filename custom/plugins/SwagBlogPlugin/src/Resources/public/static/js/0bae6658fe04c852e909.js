"use strict";(window["webpackJsonpPluginswag-blog-plugin"]=window["webpackJsonpPluginswag-blog-plugin"]||[]).push([[955],{955:function(e,t,a){a.r(t),a.d(t,{default:function(){return o}});let{Mixin:i,Data:{Criteria:l}}=Shopware;var o={template:'{% block swag_blog_detail %}\n	<sw-page class="swag-blog-detail">\n\n		<template #smart-bar-header>\n			<h2 v-if="blog && blog.title">\n				{{ blog.title }}\n			</h2>\n			<h2 v-else>\n				{{ $tc(\'swag-blog.detail.titleNew\') }}\n			</h2>\n		</template>\n\n		<template #smart-bar-actions>\n			<sw-button variant="primary" :disabled="isLoading" @click="onSave">\n				{{ $tc(\'global.default.save\') }}\n			</sw-button>\n		</template>\n\n		<template #content>\n			<sw-card-view>\n				<sw-card :title="$tc(\'swag-blog.detail.cardGeneral\')">\n					<sw-text-field v-model:value="blog.title" label="Title" :error="blog.errors?.title" required/>\n					<sw-textarea-field v-model:value="blog.description" label="Description" :error="blog.errors?.description"/>\n\n					<sw-text-field\n					v-model:value="blog.author" label="Author" :error="blog.errors?.author" required/>\n\n					\n					<sw-single-select v-model:value="blog.categoryId" label="Category" :error="blog.errors?.categoryId" :options="categoryOptions" display-field="label" value-property="value" placeholder="Select a category"/>\n					<sw-datepicker v-model:value="blog.publishedAt" :label="$tc(\'swag-blog.detail.labelPublishedAt\')" size="medium" required :date-type="isDateTime" :error="blog.errors?.publishedAt"/>\n\n					<swag-blog-media-form :blog="blog" :disabled="isLoading"/>\n\n				</sw-card>\n\n\n			</sw-card-view>\n		</template>\n	</sw-page>\n{% endblock %}\n',inject:["repositoryFactory"],mixins:[i.getByName("notification"),i.getByName("placeholder")],data(){return{blog:{title:"",description:"",author:"",categoryId:null,mainImageId:null,gallery:null,errors:{},publishedAt:null},categories:[],isLoading:!1,isSaveSuccessful:!1}},computed:{blogRepository(){return this.repositoryFactory.create("swag_blog")},blogMediaRepository(){return this.repositoryFactory.create("swag_blog_media")},categoryRepository(){return this.repositoryFactory.create("swag_blog_category")},categoryOptions(){return this.categories.map(e=>({value:e.id,label:e.name}))}},created(){this.loadCategories(),this.loadEntity()},methods:{loadCategories(){let e=new l(1,100);e.addSorting(l.sort("name","ASC")),this.categoryRepository.search(e,Shopware.Context.api).then(e=>{this.categories=e})},loadEntity(){this.isLoading=!0,this.blogRepository.get(this.$route.params.id,Shopware.Context.api,{associations:["mainImage","gallery","gallery.media"]}).then(e=>{e.gallery&&0!==e.gallery.length?Shopware.Data.EntityCollection.isEntityCollection(e.gallery)||(e.gallery=this.blogMediaRepository.createCollection(e.gallery)):e.gallery=this.blogMediaRepository.createCollection(),e.mainImage||(e.mainImage=null),this.blog=e,this.blog.title=e.title,this.blog.description=e.description,this.blog.author=e.author,this.blog.categoryId=e.categoryId,this.blog.mainImageId=e.mainImageId,this.blog.publishedAt=e.publishedAt}).finally(()=>{this.isLoading=!1})},onSave(){if(this.blog.errors={},!this.blog.title||""===this.blog.title.trim()){this.blog.errors={title:"Title must not be empty."},this.createNotificationError({message:this.$tc("swag-blog.detail.messageTitleRequired")||"Please fill the Title field."});return}this.isLoading=!0,this.isSaveSuccessful=!1,this.blogRepository.save(this.blog,Shopware.Context.api).then(()=>{this.isSaveSuccessful=!0,this.createNotificationSuccess({message:this.$tc("swag-blog.detail.messageSaveSuccess")})}).catch(()=>{this.createNotificationError({message:this.$tc("swag-blog.detail.messageSaveError")})}).finally(()=>{this.isLoading=!1})}}}}}]);